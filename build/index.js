!function(){"use strict";var e,t={728:function(e,t,a){var o=window.wp.element,l=window.wp.blocks,c=window.wp.i18n,r=window.jQuery,n=a.n(r);let i={};function m(e,t,a){t.forEach(((t,o)=>{0===o?e.append(new Option(t,a[o],!0,!0)):e.append(new Option(t,a[o]))}))}document.addEventListener("DOMContentLoaded",(function(){document.querySelectorAll(".traficom-block").forEach((e=>{const t=n()(e.querySelector(".traficom-block-checked-year")).select2(),a=n()(e.querySelector(".traficom-block-model")).select2(),o=e.querySelector(".traficom-data-table");n()(t).add(a).on("change",(e=>{let l=t.val(),c=encodeURIComponent(a.val());l&&c&&(i.year_key=l,i.model_key=c,function(e,t){n()(e).DataTable().ajax.reload()}(o))})),function(e,t){n().ajax({url:"/wp-json/traficom-api/v1/dropdown-values/",dataType:"json",type:"GET",success:a=>{const o=n()(e.querySelector(".traficom-block-checked-year")),l=n()(e.querySelector(".traficom-block-model")),c=e.querySelector(".traficom-data-table"),r=n()("html").attr("lang");t.year=a.checkedYears[0],t.year_key=a.checkedYearsKeys[0],t.model=a.models[0],t.model_key=a.modelsKeys[0],m(o,a.checkedYears,a.checkedYearsKeys),m(l,a.models,a.modelsKeys),function(e,t,a){n()(e).DataTable({ajax:{url:"/wp-json/traficom-api/v1/disqualified-cars/",type:"GET",dataSrc:"data",data:function(){return{year:t.year_key,model:t.model_key}}},language:{url:`//cdn.datatables.net/plug-ins/1.13.4/i18n/${a}.json`},data:[],columns:[{data:"model"},{data:"first_year"},{data:"amount"},{data:"average"},{data:"median"},{data:"rejection_percent"},{data:"approved"},{data:"rejected"}],dom:"Bfrtip",buttons:[{extend:"columnsToggle",columns:".toggle"}],responsive:!0})}(c,t,r)}})}(e,i)}))})),(0,l.registerBlockType)("traficom-block/traficom-data",{title:(0,c.__)("Traficom Data","traficom-block"),icon:"list-view",category:"widgets",edit(){return(0,o.createElement)("div",{className:"traficom-block-editor"},(0,o.createElement)("p",null,(0,c.__)("Tämä lohko mahdollistaa katsastusdatan hakemisen vuoden ja autonmallin perusteella.","traficom-block")))},save(){return(0,o.createElement)("div",{className:"traficom-block"},(0,o.createElement)("label",{className:"traficom-block-model-label traficom-block-label traficom-block-full-label"},(0,c.__)("Automalli:","traficom-block"),(0,o.createElement)("select",{className:"traficom-block-model traficom-select2",multiple:!0})),(0,o.createElement)("label",{className:"traficom-block-checked-year-label traficom-block-label traficom-block-half-label"},(0,c.__)("Katsastusvuosi:","traficom-block"),(0,o.createElement)("select",{className:"traficom-block-checked-year traficom-select2"})),(0,o.createElement)("table",{className:"traficom-data-table",width:"100%"},(0,o.createElement)("thead",null,(0,o.createElement)("tr",null,(0,o.createElement)("th",null,(0,c.__)("Automalli","traficom-block")),(0,o.createElement)("th",null,(0,c.__)("Käyttöönottovuosi","traficom-block")),(0,o.createElement)("th",null,(0,c.__)("Katsastusmäärä","traficom-block")),(0,o.createElement)("th",{className:"toggle"},(0,c.__)("KA. ajokilometrit","traficom-block")),(0,o.createElement)("th",{className:"toggle"},(0,c.__)("Mediaani ajokilometrit","traficom-block")),(0,o.createElement)("th",{className:"toggle"},(0,c.__)("Hylkäysprosentti","traficom-block")),(0,o.createElement)("th",{className:"toggle"},(0,c.__)("Hyväksytty","traficom-block")),(0,o.createElement)("th",{className:"toggle"},(0,c.__)("Hylätty","traficom-block"))))))}})}},a={};function o(e){var l=a[e];if(void 0!==l)return l.exports;var c=a[e]={exports:{}};return t[e](c,c.exports,o),c.exports}o.m=t,e=[],o.O=function(t,a,l,c){if(!a){var r=1/0;for(s=0;s<e.length;s++){a=e[s][0],l=e[s][1],c=e[s][2];for(var n=!0,i=0;i<a.length;i++)(!1&c||r>=c)&&Object.keys(o.O).every((function(e){return o.O[e](a[i])}))?a.splice(i--,1):(n=!1,c<r&&(r=c));if(n){e.splice(s--,1);var m=l();void 0!==m&&(t=m)}}return t}c=c||0;for(var s=e.length;s>0&&e[s-1][2]>c;s--)e[s]=e[s-1];e[s]=[a,l,c]},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,{a:t}),t},o.d=function(e,t){for(var a in t)o.o(t,a)&&!o.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={826:0,431:0};o.O.j=function(t){return 0===e[t]};var t=function(t,a){var l,c,r=a[0],n=a[1],i=a[2],m=0;if(r.some((function(t){return 0!==e[t]}))){for(l in n)o.o(n,l)&&(o.m[l]=n[l]);if(i)var s=i(o)}for(t&&t(a);m<r.length;m++)c=r[m],o.o(e,c)&&e[c]&&e[c][0](),e[c]=0;return o.O(s)},a=self.webpackChunktraficom_data_block=self.webpackChunktraficom_data_block||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var l=o.O(void 0,[431],(function(){return o(728)}));l=o.O(l)}();